# dolcanvas - 프로젝트 가이드

## 프로젝트 목적

이 프로젝트는 **AI 에이전트(특히 Claude Code)를 활용한 개발 프로세스를 검증**하기 위한 실험적 프로젝트입니다.

목표:
- AI 에이전트가 얼마나 효과적으로 웹 애플리케이션을 개발할 수 있는가?
- 복잡도가 증가할 때 AI가 얼마나 잘 대응하는가?
- 기술 스택 변경(마이그레이션) 시 AI의 역할은?

## 프로젝트 개요

**dolcanvas**는 실시간 공유 그림판 웹 애플리케이션입니다.

### 기술 스택
- **Frontend**: React 19 + Vite 7 + TypeScript + Native Canvas API
- **Backend**: Node.js + TypeScript + ws (WebSocket)
- **패키지 관리**: pnpm workspace
- **코드 품질**: ESLint 9 + Prettier

### 프로젝트 구조

```
dolcanvas/
├── client/          # React + Vite + TypeScript 프론트엔드
├── server/          # Node.js + WebSocket 백엔드
├── shared/          # 클라이언트-서버 간 공유 타입
├── AGENTS.md        # 이 파일 - 프로젝트 전체 가이드
└── package.json     # 루트 패키지 (워크스페이스 관리)
```

### WebSocket 선택 이유

**WebSocket 선택** (WebRTC 대신):
- 구현이 단순하고 직관적
- 방(Room) 관리가 쉬움
- 서버에서 데이터 히스토리 관리 가능
- 나중에 들어온 사용자에게 기존 그림 전송 가능
- 디버깅이 용이함
- 초기 프로토타입에 적합

## 개발 명령어

```bash
# 전체 개발 서버 실행 (client + server 동시)
pnpm dev

# 빌드
pnpm build

# 린트
pnpm lint

# 포맷
pnpm format
```

## 작업 시 주의사항

1. **타입 정의**: `shared/src/types.ts`에 공통 타입이 정의되어 있습니다. 클라이언트-서버 간 통신 시 이 타입을 사용하세요.

2. **WebSocket 메시지**: 모든 WebSocket 메시지는 `WSMessage<T>` 형식을 따릅니다.

3. **최신 라이브러리**: 새 의존성을 추가할 때는 가급적 최신 버전을 사용하세요.

4. **모노레포 패키지 추가**:
   - 워크스페이스 전체: `pnpm add -w <package>`
   - 특정 패키지: `cd <package> && pnpm add <package>`

## 개발 단계

### Phase 1: 기본 펜 그리기 ✅ 완료
- 기본 펜 그리기 기능
  - 색상 선택 (8개 프리셋)
  - 굵기 조절 (1-20px)
  - Canvas API 활용
- 캔버스 지우기 (전체 초기화)

### Phase 2: 실시간 동기화 (현재)
- WebSocket 연결
- 그림 데이터 브로드캐스트
- 여러 사용자 동시 작업
- 새 사용자 입장 시 기존 그림 동기화

### Phase 3: 추가 기능
- 방(Room) 개념 - 여러 그림판 세션 분리
- 도형 도구 - 사각형, 원, 선 그리기
- 텍스트 추가
- 지우개 도구
- Undo/Redo 기능
- 사용자 커서 표시
- 저장/불러오기 - 그림 저장 및 복원

## AI 에이전트 활용 방향

### 1. 점진적 기능 개발

각 Phase를 단계적으로 구현하면서 AI가 얼마나 효과적으로 기능을 구현하는지 관찰합니다.

### 2. 코드 품질 검증
- AI가 생성한 코드의 품질
- TypeScript 타입 안정성
- 버그 발생 빈도
- 코드 가독성 및 유지보수성

### 3. 라이브러리 마이그레이션 테스트
**중요**: 이 프로젝트는 Native Canvas API로 시작하지만, 나중에 Fabric.js나 Konva.js로 마이그레이션하는 것을 고려합니다.

**테스트 시나리오**:
1. Native Canvas로 기본 기능 구현
2. 도형/텍스트 기능 추가 시 복잡도 증가 관찰
3. Fabric.js로 마이그레이션 요청
4. AI가 마이그레이션을 얼마나 효과적으로 수행하는가?
5. 기존 기능이 정상 작동하는가?

### 4. 디버깅 및 문제 해결
- AI가 버그를 얼마나 빠르게 진단하고 수정하는가?
- 오류 메시지를 보고 근본 원인을 파악하는가?
- 최적화 제안을 하는가?

## 구현 가이드라인

AI 에이전트에게 작업을 요청할 때:

### ✅ DO (권장)
- **명확하고 구체적인 요청**: "펜 색상 선택 UI를 추가해줘. 빨강, 파랑, 녹색, 검정 네 가지 색상."
- **단계별 접근**: 한 번에 하나의 기능씩 구현
- **테스트 요청**: "구현 후 로컬에서 테스트할 수 있게 실행 방법 알려줘"
- **타입 안정성 강조**: "shared 패키지의 타입을 사용해서 구현해줘"
- **코드 리뷰 요청**: "이 코드에 문제가 있을까? 개선점은?"
- **진행상황 업데이트**: 작업 완료 시 AGENTS.md의 체크리스트와 프로젝트 상태를 업데이트

### ❌ DON'T (비권장)
- 모호한 요청: "그림판을 만들어줘"
- 지나치게 복잡한 한 번의 요청
- 검증 없이 다음 기능으로 넘어가기

## 검증 체크리스트

### Phase 1: 기본 펜 그리기 ✅ 완료
- [x] 프로젝트 세팅 완료
- [x] Canvas 요소 렌더링
- [x] 마우스 드래그로 선 그리기
- [x] 색상 선택 UI (8개 프리셋 색상)
- [x] 선 굵기 조절 (1-20px, 실시간 미리보기)
- [x] 캔버스 지우기

### Phase 2: 실시간 동기화
- [ ] WebSocket 서버 연결
- [ ] 그림 데이터 브로드캐스트
- [ ] 여러 브라우저에서 동시 작업 테스트
- [ ] 새 사용자 입장 시 기존 그림 동기화

### Phase 3: 추가 기능
- [ ] 도형 도구 (사각형, 원, 선)
- [ ] 텍스트 추가
- [ ] 지우개 도구
- [ ] Undo/Redo
- [ ] 사용자 커서 표시

### 마이그레이션 테스트 (선택)
- [ ] Fabric.js로 전환 요청
- [ ] 기존 기능 정상 작동 확인
- [ ] 코드 품질 비교
- [ ] 마이그레이션 소요 시간 측정

## 호스팅 옵션

**현재**: 로컬 개발
**향후 배포 옵션**: Glitch, Render, Railway 등 무료 호스팅 서비스

## 문서화

AI와의 작업 과정에서 다음을 기록하세요:
- 성공적이었던 프롬프트 패턴
- 실패하거나 어려웠던 부분
- AI가 제안한 유용한 개선 사항
- 예상치 못한 버그나 문제

## 결론

이 프로젝트를 통해 AI 에이전트가 실제 개발 워크플로우에서 얼마나 유용한지, 어떤 부분에서 강점과 약점이 있는지 파악할 수 있습니다.

---
**마지막 업데이트**: 2026-02-05
**프로젝트 상태**: Phase 1 완료, Phase 2 준비 완료

### Phase 1 구현 내역
- Canvas 컴포넌트: 전체 화면 캔버스, 마우스 이벤트 처리
- useDrawing 훅: 임페러티브 렌더링으로 성능 최적화
- Toolbar 컴포넌트: 색상 팔레트, 선 굵기 슬라이더, 지우기 버튼
- 유틸리티: drawingUtils (렌더링), idGenerator (ID 생성)
- shared 패키지: 빌드 없이 TypeScript 소스 직접 사용
